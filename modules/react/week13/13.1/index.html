<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>13.1 Context API and LocalStorage | MAD9022</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="Fullstack: Frontend Development Course">
    
    <link rel="preload" href="/w2023/assets/css/0.styles.33e990fb.css" as="style"><link rel="preload" href="/w2023/assets/js/app.49733bfc.js" as="script"><link rel="preload" href="/w2023/assets/js/2.e00fc094.js" as="script"><link rel="preload" href="/w2023/assets/js/30.5d45979f.js" as="script"><link rel="preload" href="/w2023/assets/js/9.b21c66c5.js" as="script"><link rel="preload" href="/w2023/assets/js/11.92cefe25.js" as="script"><link rel="prefetch" href="/w2023/assets/js/10.41910312.js"><link rel="prefetch" href="/w2023/assets/js/12.b4bafa0d.js"><link rel="prefetch" href="/w2023/assets/js/13.ba803485.js"><link rel="prefetch" href="/w2023/assets/js/14.1e383464.js"><link rel="prefetch" href="/w2023/assets/js/15.bacbf527.js"><link rel="prefetch" href="/w2023/assets/js/16.e7714ee9.js"><link rel="prefetch" href="/w2023/assets/js/17.3aada0e0.js"><link rel="prefetch" href="/w2023/assets/js/18.96ead32f.js"><link rel="prefetch" href="/w2023/assets/js/19.4e5249bf.js"><link rel="prefetch" href="/w2023/assets/js/20.5dee1097.js"><link rel="prefetch" href="/w2023/assets/js/21.ec6718fa.js"><link rel="prefetch" href="/w2023/assets/js/22.fa6508dc.js"><link rel="prefetch" href="/w2023/assets/js/23.9a4c47c6.js"><link rel="prefetch" href="/w2023/assets/js/24.b2a84dff.js"><link rel="prefetch" href="/w2023/assets/js/25.85a09377.js"><link rel="prefetch" href="/w2023/assets/js/26.f1eb484c.js"><link rel="prefetch" href="/w2023/assets/js/27.25c44fa0.js"><link rel="prefetch" href="/w2023/assets/js/28.51999317.js"><link rel="prefetch" href="/w2023/assets/js/29.65075bca.js"><link rel="prefetch" href="/w2023/assets/js/3.1ae5a99d.js"><link rel="prefetch" href="/w2023/assets/js/31.22b62fdb.js"><link rel="prefetch" href="/w2023/assets/js/32.bd051bb4.js"><link rel="prefetch" href="/w2023/assets/js/33.56eaee4e.js"><link rel="prefetch" href="/w2023/assets/js/34.62593793.js"><link rel="prefetch" href="/w2023/assets/js/35.4456d2ac.js"><link rel="prefetch" href="/w2023/assets/js/36.2f2d8a40.js"><link rel="prefetch" href="/w2023/assets/js/37.5e082827.js"><link rel="prefetch" href="/w2023/assets/js/38.71855794.js"><link rel="prefetch" href="/w2023/assets/js/39.485f42ce.js"><link rel="prefetch" href="/w2023/assets/js/4.64bbff17.js"><link rel="prefetch" href="/w2023/assets/js/40.8e5ddf6e.js"><link rel="prefetch" href="/w2023/assets/js/41.fea3541d.js"><link rel="prefetch" href="/w2023/assets/js/42.d3040fe8.js"><link rel="prefetch" href="/w2023/assets/js/43.0e1d1cc9.js"><link rel="prefetch" href="/w2023/assets/js/44.fbbee689.js"><link rel="prefetch" href="/w2023/assets/js/45.90d16594.js"><link rel="prefetch" href="/w2023/assets/js/46.fa7c6a52.js"><link rel="prefetch" href="/w2023/assets/js/47.3fb6e90a.js"><link rel="prefetch" href="/w2023/assets/js/48.2c7860fe.js"><link rel="prefetch" href="/w2023/assets/js/5.8ce5e2d0.js"><link rel="prefetch" href="/w2023/assets/js/6.a0bc34a0.js"><link rel="prefetch" href="/w2023/assets/js/7.0dc96026.js"><link rel="prefetch" href="/w2023/assets/js/8.c36795df.js">
    <link rel="stylesheet" href="/w2023/assets/css/0.styles.33e990fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/w2023/" class="home-link router-link-active"><!----> <span class="site-name">MAD9022</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/w2023/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/w2023/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/w2023/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/w2023/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/w2023/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/w2023/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hybrid</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web Components &amp; PWAs</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/w2023/modules/reading/" class="sidebar-link">Reading Week</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/w2023/modules/react/week9/9.1/" class="sidebar-link">9.1: React Concepts</a></li><li><a href="/w2023/modules/react/week9/9.2/" class="sidebar-link">9.2: React Setup</a></li><li><a href="/w2023/modules/react/week10/10.1/" class="sidebar-link">10.1: JSX &amp; Components</a></li><li><a href="/w2023/modules/react/week10/10.2/" class="sidebar-link">10.2: Data, Conditional Rendering &amp; PropTypes</a></li><li><a href="/w2023/modules/react/week11/11.1/" class="sidebar-link">11.1: Synthetic Events and Props</a></li><li><a href="/w2023/modules/react/week11/11.2/" class="sidebar-link">11.2: State and Hooks</a></li><li><a href="/w2023/modules/react/week12/12.1/" class="sidebar-link">12.1: React Routing</a></li><li><a href="/w2023/modules/react/week12/12.2/" class="sidebar-link">12.2: Axios, Fetch, &amp; Spinners</a></li><li><a href="/w2023/modules/react/week13/13.1/" aria-current="page" class="active sidebar-link">13.1: Context API and Storage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#context-api" class="sidebar-link">Context API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#context-and-provider-objects" class="sidebar-link">Context and Provider Objects</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#the-custom-hook" class="sidebar-link">The Custom Hook</a></li></ul></li><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#localstorage-custom-hook" class="sidebar-link">LocalStorage Custom Hook</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#usereducer-hook" class="sidebar-link">useReducer Hook</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#usecallback-hook" class="sidebar-link">useCallback Hook</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#usememo-hook" class="sidebar-link">useMemo Hook</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/react/week13/13.1/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/w2023/modules/react/week13/13.2/" class="sidebar-link">13.2: Styling and Themeing</a></li><li><a href="/w2023/modules/react/week14/14.1/" class="sidebar-link">14.1: Production Builds</a></li><li><a href="/w2023/modules/react/week14/14.2/" class="sidebar-link">14.2: React Project</a></li><li><a href="/w2023/modules/react/week15/" class="sidebar-link">15: React Project</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deliverables</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    React
  </div> <h1>13.1 Context API and LocalStorage</h1></header> <h2 id="context-api"><a href="#context-api" class="header-anchor">#</a> Context API</h2> <p>React <a href="https://react.dev/learn/passing-data-deeply-with-context" target="_blank" rel="noopener noreferrer">Context API reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The Context API is one way that you can manage global state data within your Application.</p> <p>We have already covered how you can create <code>state</code> variables in every component and how you can pass those values down from a parent to a child through <code>props</code>. We can create a state variable in the
<code>App</code> component and then pass it down through <code>props</code> to every other component in the web app. We can also pass down the <code>set</code> function for the <code>App</code>'s state variable through <code>props</code>.</p> <p>There is nothing stopping any developer from passing everything through <code>props</code>. However, it does make for a lot more code and therefore more difficult maintenance, plus wasted memory by passing all
the values and objects from the top.</p> <p>Instead, with <code>Context</code> we can create a global object that has a <code>useContext</code> hook which can be called directly from any component that needs access to the information.</p> <div class="custom-block danger"><p class="custom-block-title">Context</p> <p>Context is not a replacement for your state variables inside components. It is meant to aid the few things that you will actually need in multiple components in different areas of your app.</p></div> <p>If you have settings like a user's name and whether or not they are logged in. This would be perfect for storage inside a Context object.</p> <p>If you have a large dataset that will have multiple components that display part of the data and other components that need to edit parts of that data, then Context would be useful too.</p> <h3 id="context-and-provider-objects"><a href="#context-and-provider-objects" class="header-anchor">#</a> Context and Provider Objects</h3> <p>The way the Context API gets used is by having a global <code>Context</code> Object, which will have a <code>Provider</code> property. The <code>Provider</code> is the part that gets wrapped around your whole app, in the same way
that the <code>BrowserRouter</code> component gets wrapped around the whole app.</p> <p>Whereever you place the <code>Provider</code> is the highest level that the data can be accessed. Typically this is done in the <code>&lt;App&gt;</code> component. The Provider is a function that gets called to load, change, or
access the data stored in the Content object.</p> <p>Let's create a basic Context object that will hold a username so that it can be accessed from anywhere in the app. Start by creating a file to hold the context object.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//UserContext.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createContext<span class="token punctuation">,</span> useState<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> UserContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//create the context object</span>

<span class="token keyword">function</span> <span class="token function">UserProvider</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//create the provider object</span>
  <span class="token comment">//it has a props object just like all component functions</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>username<span class="token punctuation">,</span> setUsername<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//state variable to hold the username</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>UserContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>username<span class="token punctuation">,</span> setUsername<span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">//create and return a Context-Provider component.</span>
  <span class="token comment">//it must have a value property which holds the state variable and a function</span>
  <span class="token comment">//the function is usually the set function returned by useState...but can be another</span>
  <span class="token comment">//{...props} destructuring adds any other props passed into the provider</span>
  <span class="token comment">//These props will include ALL the components nested inside the Provider (children)!</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//create a custom hook that can be called from components</span>
  <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>UserContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//we use the built-in useContext hook to access our own Context object.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>context<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Not inside the Provider'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> context<span class="token punctuation">;</span> <span class="token comment">// [username, setUsername]</span>
  <span class="token comment">//we are returning our own state variable and function from UserContext Provider</span>
<span class="token punctuation">}</span>

<span class="token comment">//export the hook and the provider</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> useUser<span class="token punctuation">,</span> UserProvider <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>We are exporting the hook <code>useUser</code> that will be used in various Components to access the data held inside the Context Object. We are exporting the Context Provider <code>UserProvider</code> to be the wrapper
around the part of the app that needs to access the Context data.</p> <p>The <code>UserProvider</code> export gives us a <code>&lt;UserProvider&gt;&lt;/UserProvider&gt;</code> component that will wrap other components. The return statement for the Provider function includes this <code>{...props}</code> which will
contain ALL the nested children components inside <code>&lt;UserProvider&gt;</code>.</p> <div class="custom-block tip"><p class="custom-block-title">props.children</p> <p>Inside every props object passed to a component will be the actual contents that were written in the JSX.
<a href="https://react.dev/learn/passing-props-to-a-component#passing-jsx-as-children" target="_blank" rel="noopener noreferrer">Learn more about props.children<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. More about this later.</p></div> <p>This <code>UserContext.js</code> file is normally put inside a folder called <code>/src/context/</code>. It will be imported at the root level where we want our data (for the UserProvider) and then again in any component
file (for the hook) where we want to access the username.</p> <p>Assuming that we want the Context Provider to wrap all the components that are inside our <code>&lt;App&gt;</code> component, will will import <code>UserProvider</code> there.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//App.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserProvider<span class="token punctuation">,</span> useUser<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../context/UserContext.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Header <span class="token keyword">from</span> <span class="token string">'./Header.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Main <span class="token keyword">from</span> <span class="token string">'./Main.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Footer <span class="token keyword">from</span> <span class="token string">'./Footer.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>username<span class="token punctuation">,</span> setUsername<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//because we are setting the value of username in the context object</span>
  <span class="token comment">//from here, we need to import the useUser hook too.</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//this runs on initial load of &lt;App&gt;</span>
    <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">'Steve'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//we will just hardcode a value to use for username</span>
    <span class="token comment">//for simplicity's sake</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>UserProvider<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>username <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Hello <span class="token punctuation">{</span>username<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Header <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Main <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Footer <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>UserProvider<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>The <code>&lt;UserProvider&gt;</code> element that we wrote above here will be converted into <code>&lt;UserContext.Provider value={[username, setUsername]} {...props} /&gt;</code>. Then the <code>{...props}</code> will be replaced with any
props plus all the child components that were written inside of <code>&lt;UserProvider&gt;</code>.</p> <p>We <strong>ARE</strong> allowed to import and use more than one Context Provider in our web apps.</p> <h3 id="the-custom-hook"><a href="#the-custom-hook" class="header-anchor">#</a> The Custom Hook</h3> <p>Once we have a Context Provider and custom hook defined in <code>UserContext.js</code>, and the <code>&lt;UserProvider&gt;</code> wrapping other components in <code>App.js</code>, then we can start giving any nested component access to the
data.</p> <p>We do NOT need to start putting props that hold data in our components to pass down to the children components.</p> <p>If you want to set a value for the state variable which is inside of the Context object, then you need to import your <code>useUser</code> custom hook.</p> <p>The custom hook acts a lot like <code>useState</code>. It returns a reference to the value from Context AND a function to use in updating that value.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useUser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../context/UserContext.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>user<span class="token punctuation">,</span> setUser<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setUser</span><span class="token punctuation">(</span><span class="token string">'some new value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//you will have set the initial default value inside the Context Provider function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>In any Component JavaScript file you can import the custom hook to gain access to the value and the function to change the value.</p> <div title="Context API and Hooks" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/XwrcHzVk6es" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="localstorage-custom-hook"><a href="#localstorage-custom-hook" class="header-anchor">#</a> LocalStorage Custom Hook</h2> <p>LocalStorage is a good example of something that is read once and written to many times. LocalStorage can be used with Context. LocalStorage can be wrapped inside a custom hook that we build
ourselves.</p> <p>The data that is saved in LocalStorage and used in a web app should have a single source of truth. You need to have a single variable that is used by the running application. This is the single source
of truth.</p> <p>When the data needs to be updated, you update that one variable.</p> <p>When you need to display the data, you get it from the one variable.</p> <p>After updating the variable, you update the backup data in LocalStorage.</p> <p>When the app loads initially, you read from LocalStorage to set the initial value in the variable.</p> <p>We can create a custom hook for dealing with LocalStorage, which can be accessed from anywhere in the app. It will do the initial read to get the data out of LocalStorage. It will also be responsible
for updating the backup version of the data from the variable.</p> <p>If you wanted to get the initial data from a remote source you could use <code>fetch</code> or <code>axios</code> to retrieve the data and set it as the initial value in LocalStorage AND in the variable.</p> <p>Here is a sample custom hook that we can use to manage values in LocalStorage.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useLocalStorage</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> initialState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//when calling our custom hook we pass in a key and an initial value.</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> storedValue <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> storedValue <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>storedValue<span class="token punctuation">)</span> <span class="token operator">:</span> initialState<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//each time useLocalStorageState is called it will return a reference</span>
  <span class="token comment">// to the state variable and the function to update the value</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div title="Custom Hooks, LocalStorage, and Axios" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/qzi-X3quu3w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="usereducer-hook"><a href="#usereducer-hook" class="header-anchor">#</a> useReducer Hook</h2> <p>The <code>useReducer</code> hook is an alternative to the <code>useState</code> hook. It is useful when you are using some type of state management system to update your state values. This is only necessary when you have
complex state objects and want to control many different scenarios that could happen to your state values.</p> <p>Here is a short video about the concept of a reducer.</p> <div title="what is a reducer" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/TOhUqDGNFtA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>And here is the signature of the <code>useReducer</code> hook. It accepts a reducer function that does something like this: <code>(state, action) =&gt; newState</code>. The useReducer hook will return an array with the
current state object plus a method to call when you want to update your state object.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialArg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The <code>initialArg</code> is the initial value for your state object.</p> <p>Here is an example that shows building a Counter Component and the reducer function knows that it is supposed to add or deduct one from the state.count property based on the value of the <code>type</code>
property passed to the <code>dispatch</code> method.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token literal-property property">Count</span><span class="token operator">:</span> <span class="token punctuation">{</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'decrement'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="usecallback-hook"><a href="#usecallback-hook" class="header-anchor">#</a> useCallback Hook</h2> <p>The <code>useCallback</code> hook lets you create a memoized version of your callback function with dependencies.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> memoizedCallback <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">doSomething</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//the function call that gets memoized</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token comment">//the dependencies mapped to the function</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>A new memoized version of the <strong>callback function</strong> is created if those dependencies change.</p> <h2 id="usememo-hook"><a href="#usememo-hook" class="header-anchor">#</a> useMemo Hook</h2> <p>Let's you <code>memoize</code> a function's return value based on the parameters that are passed to it. Memoizing relies on <code>pure</code> functions - a function that always returns the same output when given the same
input. If you have to call a function repeatedly with the same small set of values then you should consider saving the results in an object where the different input values are the keys and the output
values are the key values.</p> <p>Here is a short video about the concept of Memoization.</p> <div title="memoization" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/_1drYP7Zm_Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>And here is a sample demonstration of the useMemo hook in action.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> memoizedValue <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//call this function and remember the result</span>
  <span class="token function">computeExpensiveValue</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//this is an array of dependencies to watch</span>
<span class="token comment">//the dependencies are the values being passed into the function.</span>
<span class="token comment">//use as many params as you need for your function.</span>
<span class="token comment">//the returned value will be remembered as a result of that combination of params.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The <code>useMemo</code> hook runs during rendering. So, if you need to call a function with a side-effect then use the <code>useEffect</code> hook.</p> <p>The purpose of this hook is to improve performance when a function is computationally expensive. It is <strong>NOT</strong> to be used on all your functions.</p> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week.</p> <ul><li>Read all the content from <code>Modules 13.1, 13.2, and 14.1</code>.</li> <li>Keep watching the <a href="https://www.youtube.com/watch?v=IkkzjbdIOBM&amp;list=PLyuRouwmQCjmMfs-HOsDGoaN6JiYrC6Ms" target="_blank" rel="noopener noreferrer">React in 2021 Video Tutorial Playlist<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/3/2023, 12:26:55 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/w2023/modules/react/week12/12.2/" class="prev">
        12.2: Axios, Fetch, &amp; Spinners
      </a></span> <span class="next"><a href="/w2023/modules/react/week13/13.2/">
        13.2: Styling and Themeing
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/w2023/assets/js/app.49733bfc.js" defer></script><script src="/w2023/assets/js/2.e00fc094.js" defer></script><script src="/w2023/assets/js/30.5d45979f.js" defer></script><script src="/w2023/assets/js/9.b21c66c5.js" defer></script><script src="/w2023/assets/js/11.92cefe25.js" defer></script>
  </body>
</html>
